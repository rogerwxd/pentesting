---
description: Checklist for privilege escalation in Linux
---

# Linux Checklist - Privilege Escalation

### Ferramenta para **Testes de** Privilege Escalation**:** [**LinPEAS**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS)

## Informações do Sistema

* [ ] Capture Informaçõe do S.O.
* [ ] Verifique os [**PATH**](privilege-escalation/#path), alguma pasta permite escrita?
* [ ] Verifique [**env variables**](privilege-escalation/#env-info), alguma opção sensível?
* [ ] Procure por [**kernel exploits**](privilege-escalation/#kernel-exploits) **usando scripts** \(DirtyCow?\)
* [ ] **Verifique** se [**sudo version** é vulnerável](privilege-escalation/#sudo-version)
* [ ] [**Dmesg** signature verification failed](privilege-escalation/#dmesg-signature-verification-failed) erro?
* [ ] Mais informações de enumeração do sistema \([date, system stats, cpu info, printers](privilege-escalation/#more-system-enumeration)\)
* [ ] [Enumerate more defenses](privilege-escalation/#enumerate-possible-defenses)

## [Drives](privilege-escalation/#drives)

* [ ] **Lista todas as unidades montadas?**
* [ ] **qual quer unidade montada?**
* [ ] **Unidades no fstab?**

## Softwares Instalados

1. [ ] **Verifique os**[ **useful software**](privilege-escalation/#useful-software) **instalados**
2. [ ] **Verifique os** [**vulnerable software**](privilege-escalation/#vulnerable-software-installed) **instalados**

## Processos

* [ ] Existe algum **software desconhecido** em execução?
* [ ] Existe algum software com mais privilégios do que deveria estar em execução?
* [ ] Procure exploits para processos em execução \(especialmente se estiver executando versões\) Você pode modificar o binário de qualquer processo em execução?
* [ ] Você pode **modificar o binário** de qualquer processo em execução?
* [ ] **Monitore os processos** e verifique se algum processo interessante está sendo executado com frequência
* [ ] ocê consegue **ler** alguma **processo da memória** interessante \(onde as senhas podem ser salvas\)?

## Tarefas / Cron / Jobs

* [ ] O [**PATH**](privilege-escalation/#cron-path) ****está sendo modificado por algum cron e você pode **escrever** nele?
* [ ] Alguma [**wildcard** ](privilege-escalation/#cron-using-a-script-with-a-wildcard-wildcard-injection)no cron job?
* [ ] Algum [**modifiable script** ](privilege-escalation/#cron-script-overwriting-and-symlink)está sendo **executado** ou está dentro de pastas com **permissão de modificação**? 
* [ ] Algum script sendo executado com muita frequência? \(entre 1, 2 or 5 minutos\)

## Serviços

* [ ] Algum **arquivo editável de .service**?
* [ ] Algum **arquivo editável binary** que executa um **serviço**?
* [ ] Alguma pasta com **permissões de escrita no PATH** do **systemd**?

## [Sockets](privilege-escalation/#sockets)

* [ ] Algum **arquivo .socket editável**?
* [ ] Você pode se comunicar com algum **socket**?
* [ ] **HTTP sockets** que possua informações interessantes?

## [D-Bus](privilege-escalation/#d-bus)

* [ ] Você pode se ****comunicar com algum **D-Bus**?

## [Network](privilege-escalation/#network)

* [ ] Enumere a rede e veja para saber onde você está
* [ ] **Abrir portas** que permitam colocar um shell?
* [ ] Você pode **sniff traffic** usando `tcpdump`?

## Usuários

* [ ] Permite a Enumeração de usuários / grupos genéricos
* [ ] Você tem um **UID muito grande**? A máquina está vulnerável?
* [ ] Você pode escalar privilégios graças a um grupo ao qual pertence?
* [ ] Dados da área de transferência?
* [ ] Políticas de Password?
* [ ] Tente usar todas as senhas conhecidas que você descobriu anteriormente para fazer o login com cada usuário possível. Tente fazer o login também sem senha.

## PATH com Escrita

* [ ] Se você tiver privilégios de gravação em alguma pasta no PATH, você poderá escalar os privilégios

## [SUDO and SUID commands](privilege-escalation/#sudo-and-suid)

* [ ] Você pode executar qualquer **comando com sudo**? Você pode usá-lo para LER, ESCREVER ou EXECUTAR qualquer coisa como root? \(GTFOBins\)
* [ ] Algum binário com **suid explorável**? \([**GTFOBins**](https://gtfobins.github.io/)\)
* [ ] Os comandos SUDO, são limitados pelo PATH, você pode contornar e fazer um bypass nas restrições?
* [ ] [**Sudo/SUID binary** ](privilege-escalation/#sudo-command-suid-binary-without-command-path)**estão sem indicação do PATH**?
* [ ] [**SUID binary** ](privilege-escalation/#suid-binary-with-command-path)**especifica o PATH**? Bypass
* [ ] [**LD\_PRELOAD vuln**](privilege-escalation/#ld_preload)
* [ ] [**Lack of .so library in SUID binary**](privilege-escalation/#suid-binary-so-injection) pasta com permissão de escrita?
* [ ] Algum Token SUDO disponível? pode ser criado?
* [ ] Você pode ler ou modificar o arquivo sudores?
* [ ] Você pode modificar[ **/etc/ld.so.conf.d/**](privilege-escalation/#etc-ld-so-conf-d)?
* [ ] [**OpenBSD DOAS**](privilege-escalation/#doas)

## Capacidades

* [ ] Algum binário tem **capacidades inexperadas**?

## [ACLs](privilege-escalation/#acls)

* [ ] Algum arquivo tem uma **ACL inexperada**?

## [Open Shell sessions](privilege-escalation/#open-shell-sessions)

* [ ] **screen**?
* [ ] **tmux**?

## [SSH](privilege-escalation/#ssh)

* [ ] **Debian** [**OpenSSL Predictable PRNG - CVE-2008-0166**](privilege-escalation/#debian-openssl-predictable-prng-cve-2008-0166)
* [ ] [**SSH Interesting configuration values**](privilege-escalation/#ssh-interesting-configuration-values)

## Arquivos Interessantes

* [ ] **Profile files** - Ler dados confidenciais? Escrever para privesc?
* [ ] **passwd/shadow files** -Ler dados confidenciais? Escrever para privesc?
* [ ] Verifique pastas com possíveis **dados sensíveis**
* [ ] **Localizações Estranhas / Arquivos próprios,** você pode ter acesso ou alterar os executáveis?
* [ ] **Arquivos Modificados** nos últimos minutos
* [ ] **Sqlite DB files**
* [ ] **Arquivos ocultos**
* [ ] **Script/Binaries in PATH**
* [ ] **Web files** \(passwords?\)
* [ ] **Backups**?
* [ ] **Arquivos conhecidos que contém senha**: Use **Linpeas** e **LaZagne**
* [ ] **Generic search**

## Arquivos de escrita

* [ ] **Modificar a Bibliotéca do Python** para executar comandos?
* [ ] Você pode modificar os **arquivos de log**? **Logtotten** exploit
* [ ] Você pode **modificar /etc/sysconfig/network-scripts/**? Centos/Redhat exploit
* [ ] você pode **escrever** em arquivos[ **.ini, int.d, systemd or rc.d files**](privilege-escalation/#init-init-d-systemd-and-rc-d)?

## Outras Opções

* [ ] você pode utilizar NFS para escalar previlégios?



