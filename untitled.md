# Reconhecimento Externo

## Descoberta de Informações

Descubrir maior número de informações de uma empresa

1. Informações de empresa principais da empresa;
2. Encontre o ASN \(se houver\) faixas de IP da empresa.
3. Whois para pesquisas reversa de DNS;
4. Shodan para filtrar informações:

### 1 - Aquisições

* Uma opção é acessar [https://www.crunchbase.com/](https://www.crunchbase.com/), procurar a empresa principal e clicar em "aquisições". Lá você verá outras empresas adquiridas pela principal.
* Outra opção é visitar a página da Wikipedia da empresa principal e pesquisar as aquisições.

### 2 - ASNs

Pesquisa pelo nome da empresa, por IP ou por domínio em 

* [https://bgp.he.net/](https://bgp.he.net/)
* [http://asnlookup.com/](http://asnlookup.com/)
* [http://ipv4info.com/](http://ipv4info.com/) 

```bash
#Automatização, mas não é recomendado, pode ser rastreado
amass intel -org tesla
amass intel -asn 8911,50313,394161
```

### 3 - Procurando Vulnerabilidade

Utilizar Escaners de Vulnerabilidade na **seção :** 

### 4 - Reverse DNS

### **Dnsrecon**

```bash
dnsrecon -r <DNS Range> -n <IP_DNS>   #DNS reverse of all of the addresses
dnsrecon -d facebook.com -r 157.240.221.35/24 #Using facebooks dns
dnsrecon -r 157.240.221.35/24 -n 1.1.1.1 #Using cloudflares dns
dnsrecon -r 157.240.221.35/24 -n 8.8.8.8 #Using google dns
```

### Reverse Whois \(loop\)

* [http://ptrarchive.com/](http://ptrarchive.com/) - **Free**
* [https://viewdns.info/reversewhois/](https://viewdns.info/reversewhois/) - **Free**
* [https://domaineye.com/reverse-whois](https://domaineye.com/reverse-whois)  - **Free**
* [https://www.reversewhois.io/](https://www.reversewhois.io/)  - **Free**
* [https://www.whoxy.com/](https://www.whoxy.com/) - **Free** web, not free API.
* [http://reversewhois.domaintools.com/](http://reversewhois.domaintools.com/) - Not free
* [https://drs.whoisxmlapi.com/reverse-whois-search](https://drs.whoisxmlapi.com/reverse-whois-search) - Not Free \(only **100 free** searches\)
* [https://www.domainiq.com/](https://www.domainiq.com/) - Not Free

### Rastreadores

Encontrar duas ID como do Google Analytics em duas paginas, pode significar que são da mesma empresa. Para rastrear, utilize:

* [https://builtwith.com/](https://builtwith.com/)
* [https://www.sitesleuth.io/](https://www.sitesleuth.io/)
* [https://publicwww.com/](https://publicwww.com/)
* [https://spyonweb.com/](https://spyonweb.com/)

### **Rastrear Favicon**

Rastrear os .ICO, através da ferramenta:  [favihash.py](https://github.com/m4ll0k/Bug-Bounty-Toolz/blob/master/favihash.py)

```bash
cat my_targets.txt | xargs -I %% bash -c 'echo "http://%%/favicon.ico"' > targets.txt
python3 favihash.py -f https://target/favicon.ico -t targets.txt -s
```

![favihash - discover domains with the same favicon icon hash](https://www.infosecmatter.com/wp-content/uploads/2020/07/favihash.jpg)

### Outras Ferramentas

### DNS

Let's try to get **subdomains** from the **DNS** records. We should also try for **Zone Transfer** \(If vulnerable, you should report it\).

```bash
dnsrecon -a -d tesla.com
```

### OSINT - Fontes Externas

* [https://pentester.land/cheatsheets/2018/11/14/subdomains-enumeration-cheatsheet.html](https://pentester.land/cheatsheets/2018/11/14/subdomains-enumeration-cheatsheet.html) - Diversas Fontes externas
* [**crt**](%20https://crt.sh/)\*\*\*\*
* \*\*\*\*[**gau**](https://github.com/lc/gau)\*\*\*\*

Outros Escanners de DNS

* [**Amass**](https://github.com/OWASP/Amass)
* [**subfinder**](https://github.com/projectdiscovery/subfinder)
* [**findomain**](https://github.com/Edu4rdSHL/findomain/)
* [**OneForAll**](https://github.com/shmilylty/OneForAll/blob/master/README.en.md)
* [**assetfinder**](https://github.com/tomnomnom/assetfinder)
* [**Sudomy**](https://github.com/Screetsec/Sudomy) 

```bash
amass enum [-active] [-ip] -d tesla.com
./subfinder-linux-amd64 -d tesla.com [-silent]
./findomain-linux -t tesla.com [--quiet]
python3 oneforall.py --target tesla.com [--dns False] [--req False] run
assetfinder --subs-only <domain>
```

Escaners para Bug-Bounty

* \*\*\*\*[**chaos.projectdiscovery.io**](https://chaos.projectdiscovery.io/#/)
* [chaospy](https://github.com/dr-0x0x/chaospy)
* [https://github.com/projectdiscovery/chaos-public-program-list](https://github.com/projectdiscovery/chaos-public-program-list)
* [SubDomainizer](https://github.com/nsonaniya2010/SubDomainizer)
* [subscraper](https://github.com/Cillian-Collins/subscraper)

#### RapidDNS

Encontrar SubDominios com[RapidDNS](https://rapiddns.io/) API \([link](https://twitter.com/Verry__D/status/1282293265597779968)\):

```text
rapiddns(){
curl -s "https://rapiddns.io/subdomain/$1?full=1" \
 | grep -oP '_blank">\K[^<]*' \
 | grep -v http \
 | sort -u
}
```

### DNS Brute force

*  [**massdns**](https://github.com/blechschmidt/massdns)
* [**gobuster**](https://github.com/OJ/gobuster)
* [**aiodnsbrute**](https://github.com/blark/aiodnsbrute)
* [**shuffledns**](https://github.com/projectdiscovery/shuffledns). 

Listas de Subdominios para utilizar as ferramentas

* [https://gist.github.com/jhaddix/86a06c5dc309d08580a018c66354a056](https://gist.github.com/jhaddix/86a06c5dc309d08580a018c66354a056)
* [https://github.com/pentester-io/commonspeak](https://github.com/pentester-io/commonspeak)

```bash
sed 's/$/.domain.com/' subdomains.txt > bf-subdomains.txt
./massdns -r resolvers.txt -w /tmp/results.txt bf-subdomains.txt
grep -E "tesla.com. [0-9]+ IN A .+" /tmp/results.txt
```

{% code title="Gobuster bruteforcing dns" %}
```bash
gobuster dns -d mysite.com -t 50 -w subdomains.txt
```
{% endcode %}

### VHosts

#### IP VHosts

Para encontrar VHosts: [HostHunter](https://github.com/SpiderLabs/HostHunter)

#### Brute Force

```bash
gobuster vhost -u https://mysite.com -t 50 -w subdomains.txt

wfuzz -c -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-20000.txt --hc 400,404,403 -H "Host: FUZZ.example.com" -u http://example.com -t 100

#From https://github.com/allyshka/vhostbrute
vhostbrute.py --url="example.com" --remoteip="10.1.1.15" --base="www.example.com" --vhosts="vhosts_full.list"
```

### DNS Brute Force v2

* [**dnsgen**](https://github.com/ProjectAnte/dnsgen)
* [**altdns**](https://github.com/infosec-au/altdns) 

## Web servers hunting

* [**httprobe**](https://github.com/tomnomnom/httprobe) 
* [**fprobe**](https://github.com/theblackturtle/fprobe).

```bash
cat /tmp/domains.txt | httprobe #Test all domains inside the file for port 80 and 443
cat /tmp/domains.txt | httprobe -p http:8080 -p https:8443 #Check port 80, 443 and 8080 and 8443
```

### Screenshots

Encontrar pontos nos dominios que possam ter vulnerabilidades

* \*\*\*\*[**EyeWitness**](https://github.com/FortyNorthSecurity/EyeWitness)\*\*\*\*
* \*\*\*\*[**HttpScreenshot**](https://github.com/breenmachine/httpscreenshot)\*\*\*\*
* \*\*\*\*[**Aquatone**](https://github.com/michenriksen/aquatone)\*\*\*\*
* \*\*\*\*[**shutter**](https://shutter-project.org/downloads/)\*\*\*\*
* \*\*\*\*[**webscreenshot**](https://github.com/maaaaz/webscreenshot)\*\*\*\*

## **Bug hunting OSINT Relatados**

### Api keys leaks in github

* [https://github.com/hisxo/gitGraber](https://github.com/hisxo/gitGraber)
* [https://github.com/eth0izzle/shhgit](https://github.com/eth0izzle/shhgit)
* [https://github.com/techgaun/github-dorks](https://github.com/techgaun/github-dorks)
* [https://github.com/michenriksen/gitrob](https://github.com/michenriksen/gitrob)
* [https://github.com/eth0izzle/shhgit](https://github.com/eth0izzle/shhgit)
* [https://github.com/anshumanbh/git-all-secrets](https://github.com/anshumanbh/git-all-secrets)
* [https://github.com/awslabs/git-secrets](https://github.com/awslabs/git-secrets)
* [https://github.com/kootenpv/gittyleaks](https://github.com/kootenpv/gittyleaks)
* [https://github.com/dxa4481/truffleHog](https://github.com/dxa4481/truffleHog)
* [https://github.com/obheda12/GitDorker](https://github.com/obheda12/GitDorker)

